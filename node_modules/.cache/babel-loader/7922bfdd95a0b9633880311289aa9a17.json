{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) {\n      if (b.hasOwnProperty(p)) d[p] = b[p];\n    }\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar React = require(\"react\");\n\nvar InteractionEvents;\n\n(function (InteractionEvents) {\n  InteractionEvents[\"MouseDown\"] = \"mousedown\";\n  InteractionEvents[\"MouseMove\"] = \"mousemove\";\n  InteractionEvents[\"MouseUp\"] = \"mouseup\";\n  InteractionEvents[\"TouchStart\"] = \"touchstart\";\n  InteractionEvents[\"TouchMove\"] = \"touchmove\";\n  InteractionEvents[\"TouchEnd\"] = \"touchend\";\n})(InteractionEvents || (InteractionEvents = {}));\n\nvar Joystick =\n/** @class */\nfunction (_super) {\n  __extends(Joystick, _super);\n\n  function Joystick(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.state = {\n      dragging: false\n    };\n    _this._stickRef = React.createRef();\n    _this._baseRef = React.createRef();\n\n    _this._throttleMoveCallback = function () {\n      var lastCall = 0;\n      return function (event) {\n        var now = new Date().getTime();\n        var throttleAmount = _this.props.throttle || 0;\n\n        if (now - lastCall < throttleAmount) {\n          return;\n        }\n\n        lastCall = now;\n\n        if (_this.props.move) {\n          return _this.props.move(event);\n        }\n      };\n    }();\n\n    _this._boundMouseUp = function () {\n      _this._mouseUp();\n    };\n\n    _this._boundMouseMove = function (event) {\n      _this._mouseMove(event);\n    };\n\n    return _this;\n  }\n\n  Joystick.prototype._updatePos = function (coordinates) {\n    var _this = this;\n\n    window.requestAnimationFrame(function () {\n      _this.setState({\n        coordinates: coordinates\n      });\n    });\n\n    this._throttleMoveCallback({\n      type: \"move\",\n      x: coordinates.relativeX,\n      y: -coordinates.relativeY,\n      direction: coordinates.direction\n    });\n  };\n\n  Joystick.prototype._mouseDown = function (e) {\n    if (this.props.disabled !== true) {\n      this._parentRect = this._baseRef.current.getBoundingClientRect();\n      this.setState({\n        dragging: true\n      });\n\n      if (e.type === InteractionEvents.MouseDown) {\n        window.addEventListener(InteractionEvents.MouseUp, this._boundMouseUp);\n        window.addEventListener(InteractionEvents.MouseMove, this._boundMouseMove);\n      } else {\n        window.addEventListener(InteractionEvents.TouchEnd, this._boundMouseUp);\n        window.addEventListener(InteractionEvents.TouchMove, this._boundMouseMove);\n      }\n\n      if (this.props.start) {\n        this.props.start({\n          type: \"start\",\n          x: null,\n          y: null,\n          direction: null\n        });\n      }\n    }\n  };\n\n  Joystick.prototype._getDirection = function (atan2) {\n    if (atan2 > 2.35619449 || atan2 < -2.35619449) {\n      return \"FORWARD\";\n    } else if (atan2 < 2.35619449 && atan2 > 0.785398163) {\n      return \"RIGHT\";\n    } else if (atan2 < -0.785398163) {\n      return \"LEFT\";\n    }\n\n    return \"BACKWARD\";\n  };\n\n  Joystick.prototype._getWithinBounds = function (value) {\n    var halfBaseSize = this._baseSize / 2;\n\n    if (value > halfBaseSize) {\n      return halfBaseSize;\n    }\n\n    if (value < -halfBaseSize) {\n      return halfBaseSize * -1;\n    }\n\n    return value;\n  };\n\n  Joystick.prototype._mouseMove = function (event) {\n    if (this.state.dragging) {\n      var absoluteX = null;\n      var absoluteY = null;\n\n      if (event.type === InteractionEvents.MouseMove) {\n        absoluteX = event.clientX;\n        absoluteY = event.clientY;\n      } else {\n        absoluteX = event.touches[0].clientX;\n        absoluteY = event.touches[0].clientY;\n      }\n\n      var relativeX = this._getWithinBounds(absoluteX - this._parentRect.left - this._baseSize / 2);\n\n      var relativeY = this._getWithinBounds(absoluteY - this._parentRect.top - this._baseSize / 2);\n\n      var atan2 = Math.atan2(relativeX, relativeY);\n\n      this._updatePos({\n        relativeX: relativeX,\n        relativeY: relativeY,\n        direction: this._getDirection(atan2),\n        axisX: absoluteX - this._parentRect.left,\n        axisY: absoluteY - this._parentRect.top\n      });\n    }\n  };\n\n  Joystick.prototype._mouseUp = function () {\n    this.setState({\n      dragging: false,\n      coordinates: undefined\n    });\n    window.removeEventListener(\"mouseup\", this._boundMouseUp);\n    window.removeEventListener(\"mousemove\", this._boundMouseMove);\n\n    if (this.props.stop) {\n      this.props.stop({\n        type: \"stop\",\n        x: null,\n        y: null,\n        direction: null\n      });\n    }\n  };\n\n  Joystick.prototype._getBaseStyle = function () {\n    var baseColor = this.props.baseColor !== undefined ? this.props.baseColor : \"#000033\";\n    var baseSizeString = this._baseSize + \"px\";\n    return {\n      height: baseSizeString,\n      width: baseSizeString,\n      background: baseColor,\n      borderRadius: this._baseSize,\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center'\n    };\n  };\n\n  Joystick.prototype._getStickStyle = function () {\n    var stickColor = this.props.stickColor !== undefined ? this.props.stickColor : \"#3D59AB\";\n    var stickSize = this._baseSize / 1.5 + \"px\";\n    var stickStyle = {\n      background: stickColor,\n      cursor: \"move\",\n      height: stickSize,\n      width: stickSize,\n      borderRadius: this._baseSize,\n      flexShrink: 0\n    };\n\n    if (this.state.dragging && this.state.coordinates !== undefined) {\n      stickStyle = Object.assign({}, stickStyle, {\n        position: 'absolute',\n        transform: \"translate3d(\" + this.state.coordinates.relativeX + \"px, \" + this.state.coordinates.relativeY + \"px, 0)\"\n      });\n    }\n\n    return stickStyle;\n  };\n\n  Joystick.prototype.render = function () {\n    this._baseSize = this.props.size || 100;\n\n    var baseStyle = this._getBaseStyle();\n\n    var stickStyle = this._getStickStyle();\n\n    return React.createElement(\"div\", {\n      className: this.props.disabled ? 'joystick-base-disabled' : '',\n      onMouseDown: this._mouseDown.bind(this),\n      onTouchStart: this._mouseDown.bind(this),\n      ref: this._baseRef,\n      style: baseStyle\n    }, React.createElement(\"div\", {\n      ref: this._stickRef,\n      className: this.props.disabled ? 'joystick-disabled' : '',\n      style: stickStyle\n    }));\n  };\n\n  return Joystick;\n}(React.Component);\n\nexports.Joystick = Joystick;","map":null,"metadata":{},"sourceType":"script"}